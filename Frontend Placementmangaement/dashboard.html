
<!DOCTYPE html>
<html>
<head>
  <title>Pie Chart Example</title>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);
    
    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawCharts);

function drawCharts() {
  fetch('http://localhost:8080/Placement/company/display')
    .then(response => response.json())
    .then(data => {
      const companyData = data.map(company => [company.companyName, company.applicableBranches.split(',').length]);
      const dataTable = new google.visualization.DataTable();
      dataTable.addColumn('string', 'Company Name');
      dataTable.addColumn('number', 'Applicable Branches');
      dataTable.addRows(companyData);

      const options = {
        title: 'The Number of Branches Which Are Eligible To Apply For a Specific Company',
        width: 400,
        height: 400,
         
      };
      const chart = new google.visualization.PieChart(document.getElementById('companyChart'));
      chart.draw(dataTable, options);
    })
    .catch(error => console.error(error));
}

    function drawChart() {
      fetch('http://localhost:8080/Placement/visit/display')
      .then(response => response.json())
      .then(data => {
        const jobProfiles = {};
        const ctcValues = {};

        data.forEach(visit => {
          const jobProfile = visit.jobprofile;
          const ctc = visit.ctc;

        

          if (ctcValues[ctc]) {
            ctcValues[ctc]++;
          } else {
            ctcValues[ctc] = 1;
          }
        });

        const jobProfileData = [['Job Profile', 'Count']];
        Object.entries(jobProfiles).forEach(([jobProfile, count]) => {
          jobProfileData.push([jobProfile, count]);
        });

        const ctcData = [['CTC', 'Count']];
        Object.entries(ctcValues).forEach(([ctc, count]) => {
          ctcData.push([ctc, count]);
        });

        const options = {
          title: 'Visits by Job Profile',
          width: 400,
          height: 400,
          
        };

        // const jobProfileChart = new google.visualization.PieChart(document.getElementById('jobProfileChart'));
        // jobProfileChart.draw(google.visualization.arrayToDataTable(jobProfileData), options);

       

        options.title = 'The Number Of Companies Which Are Offering Similar CTC';

        const ctcChart = new google.visualization.PieChart(document.getElementById('ctcChart'));
        ctcChart.draw(google.visualization.arrayToDataTable(ctcData), options);
      })
      .catch(error => console.error(error));
    }
  </script>
</head>
<body>
  <div style="display: flex; gap: 50px;">
  <div id="jobProfileChart"></div>
  <div id="ctcChart"></div>
  <div id="companyChart"></div>
  </div>
</body>
</html>


<!-- // if (jobProfiles[jobProfile]) {
  //   jobProfiles[jobProfile]++;
  // } else {
  //   jobProfiles[jobProfile] = 1;
  // }
   



